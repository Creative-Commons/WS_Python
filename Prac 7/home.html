<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    </head>
<body onload="get_products()">

<h1>Product</h1>

<script type="text/javascript">
    var api_url = 'http://127.0.0.1:5000/';

    /* GET REQUEST */
    function get_products(){
        fetch(api_url).then(response => {
            return response.json();
        }).then(data => {
            //console.log(data);
            var table = document.getElementById("product_table");
            for(i = 0; i < data["products"].length; i++){
                row = table.insertRow(table.rows.length);
                for(var key in data["products"][i]){
                    //console.log(data["products"][i][key]);
                    cell = row.insertCell();
                    cell.innerHTML = data["products"][i][key];
                }
            }
        });
    }
    
    /* POST REQUEST */
    function create_product(){
        var name = document.getElementById("name");
        var price = document.getElementById("price");
        fetch(
            api_url, {
            method: "POST",
            body: JSON.stringify({
                name: name.value,
                price: price.value
            }),
            headers: {
                "Content-type": "application/json; charset=UTF-8"
            }
        }).then(
            response => response.json()
        ).then(
            json => console.log(json))
        get_products()
    }
    
</script>

<div class="container">
    <table id="product_table" class="table table-bordered">
        <thead>
            <th>Id</th>
            <th>Name</th>
            <th>Price</th>
        </thead>
    </table>
</div>
<hr>
<div class="text-center mt-5">
    <span class="h3">Create Product</span>
    <table class="table">
        <form onsubmit="create_product()">
            <tr>
                <td><input type="text" id="name" placeholder="Enter Product Name" required></td>
                <td><input type="number" id="price" placeholder="Enter Price" required></td>
            <tr><td colspan="2" ><input type="submit" class="btn btn-success btn-block" value="Insert Product"></td></tr>
            </tr>
        </form>
    </table>
</div>

</body>
</html>